<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>amazon - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":true,"enableJobsAclsV2InUI":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableFindAndReplace":true,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"3.2.x-scala2.10","displayName":"3.2 alpha (Scala 2.10)","packageLabel":"spark-image-26c743079a9a928128a9ead6776c8e2bfc0cdd8b1643e6a53e4b9b5dd9405dc2","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (3.3 snapshot, Scala 2.10)","packageLabel":"spark-image-7d36db2ec4126519915e5de5f52fa6bea4326dae75df49e6e8ef89cb8eed8de8","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"latest-rc-scala2.11","displayName":"Latest RC (3.2, Scala 2.11)","packageLabel":"spark-image-ef8dd0b7936966e0a7a43bd34b661759290031d3b85ea1c8ae1c8aee09d2e95a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"latest-stable-scala2.11","displayName":"Latest stable (3.1, Scala 2.11)","packageLabel":"spark-image-0e50da7a73d3bc76fcca8ac8a67c1e036c5a30deb5663adf6d0f332cc8ec2c90","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"latest-rc-scala2.10","displayName":"Latest RC (3.2, Scala 2.10)","packageLabel":"spark-image-26c743079a9a928128a9ead6776c8e2bfc0cdd8b1643e6a53e4b9b5dd9405dc2","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"latest-stable-scala2.10","displayName":"Latest stable (3.1, Scala 2.10)","packageLabel":"spark-image-0c03d5f78139022c37032b5f3ffac5b5a4445d9cab8733e333f16a67a47262f9","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0e50da7a73d3bc76fcca8ac8a67c1e036c5a30deb5663adf6d0f332cc8ec2c90","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-0c03d5f78139022c37032b5f3ffac5b5a4445d9cab8733e333f16a67a47262f9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (3.3 snapshot, Scala 2.11)","packageLabel":"spark-image-5aa4cbcc9e8b7ea39754718aa6d13f39d1a916343d0b3708d213dbc0664ffc62","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"3.2.x-scala2.11","displayName":"3.2 alpha (Scala 2.11)","packageLabel":"spark-image-ef8dd0b7936966e0a7a43bd34b661759290031d3b85ea1c8ae1c8aee09d2e95a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false}],"enableClearStateAndRunAll":true,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"r4.16xlarge":16,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":8,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.375,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1.5,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.51","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"preferStartTerminatedCluster":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableStructuredDataAcls":false,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"edf38246235114c5bcdbe48b410c94e545836029","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3044375745343556,"name":"amazon","language":"python","commands":[{"version":"CommandV1","origId":3044375745343590,"guid":"da560c84-8423-4749-8239-152a10cd1d60","subtype":"command","commandType":"auto","position":0.5,"command":"%md  ##       Amazon Reviews Classification with SparkML Python API","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1501544640438,"submitTime":1501544640438,"finishTime":1501544658577,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"13797091-5766-4fdd-ad8e-d133753f1eee"},{"version":"CommandV1","origId":3044375745343592,"guid":"86e6d1a0-290e-4c5c-979f-96aa47d3769b","subtype":"command","commandType":"auto","position":0.75,"command":"%md\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nAs many companies create more volumes and varieties of data, there is a growing need for a framework to process and analyze large-scale datasets with parallel and distributed algorithms. Apache Spark is a fast and efficient cluster framework that uses Resilient Distributed Dataset (RDD) to partition large datasets and allows parallel and fast computation of data processing in memory. \nSpark Machine Learning API provides two packages called spark.mllib and spark.ml. Spark MLlib package contains the Spark machine learning API built on RDDs. Spark ML package has machine learning API built on the DataFrames\nwhich are part of Spark SQL library. Spark ML also uses pipeline to combine multiple tasks together, such as data transformation, model fitting, and model validation. \n<br \\>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nIn this project, I apply the Apache Spark framework to perform text classification of Amazon reviews by Spark ML. Spark ML API is available in Scala, Java, and Python languages. \nThis projects demonstrates sentiment analysis of Amazon review data by developing Logistic Regression, Naïve Bayes, Decision Tree, Random Forest, and Gradient Boosted Tree classifiers. I compare the performance of these classifiers by evaluating the classification accuracy. \n<br \\>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nThis notebook is written using PySpark (Python API). I use **Spark 2.1.1** provided by **Databricks** for this project.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2af75c9e-fc79-438c-b166-311e0f76b19a"},{"version":"CommandV1","origId":3044375745343593,"guid":"78e37a98-4680-4467-8629-d8f91ce757f6","subtype":"command","commandType":"auto","position":0.875,"command":"%md  ### Load libraries","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"66a0a463-eaac-421f-892e-5681ae1f76eb"},{"version":"CommandV1","origId":3044375745343557,"guid":"4046264c-ebca-4872-a036-78a9f0442b48","subtype":"command","commandType":"auto","position":1.0,"command":"import warnings\nwarnings.filterwarnings('ignore')\nimport pandas as pd\npd.options.display.mpl_style = 'default'\n\nfrom pyspark.ml import *\nfrom pyspark.ml.classification import *\nfrom pyspark.ml.feature import *\nfrom pyspark.ml.param import *\nfrom pyspark.ml.tuning import *\nfrom pyspark.ml.evaluation import *\nfrom pyspark.sql.types import DoubleType\nfrom pyspark.sql.functions import rand \nfrom sklearn.metrics import classification_report\nfrom time import time\nfrom pyspark import SparkContext, SparkConf\nfrom pyspark.sql import SQLContext, Row","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1502998730046,"submitTime":1502998729066,"finishTime":1502998731498,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Load libraries","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f8d20517-345c-4535-b07a-ac38713978d6"},{"version":"CommandV1","origId":3044375745343563,"guid":"cb114d32-43e5-479e-ab5b-a0b808729384","subtype":"command","commandType":"auto","position":1.0625,"command":"print \"Running Spark Version %s\" % (sc.version)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Running Spark Version 2.1.1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502991198544,"submitTime":1502991198505,"finishTime":1502991198621,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6f43aff1-61e6-4f98-a129-5c3a93fec18e"},{"version":"CommandV1","origId":3044375745343594,"guid":"77837add-3adf-47e6-8361-f534858ff2c0","subtype":"command","commandType":"auto","position":1.06640625,"command":"%md  ### Load Data\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \nThe Amazon review data is download from http://archive.ics.uci.edu/ml/datasets/Sentiment+Labelled+Sentences. This dataset was created for the Paper 'From Group to Individual Labels using Deep Features', Kotzias et. al,. KDD 2015. It consists of review sentences labelled with positive or negative sentiment (500 positive and 500 negative labels). The data file is uploaded to Databricks File System. A text file RDD is created using SparkContext method which reads the file as a collection of lines. The first five reviews with their labels are displayed below. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da206c5d-fb37-40fc-aefe-61a8d45fdbde"},{"version":"CommandV1","origId":3044375745343569,"guid":"956e4b9f-2674-4784-a910-30842be87969","subtype":"command","commandType":"auto","position":1.0703125,"command":"rdd1 = sc.textFile(\"/FileStore/tables/c4pzqsme1501527259399/amazon_cells_labelled.txt\")\nrdd1.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">2</span><span class=\"ansired\">]: </span>\n[u&apos;So there is no way for me to plug it in here in the US unless I go by a converter.\\t0&apos;,\n u&apos;Good case, Excellent value.\\t1&apos;,\n u&apos;Great for the jawbone.\\t1&apos;,\n u&apos;Tied to charger for conversations lasting more than 45 minutes.MAJOR PROBLEMS!!\\t0&apos;,\n u&apos;The mic is great.\\t1&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502991931238,"submitTime":1502991931191,"finishTime":1502991932553,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Load Data","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da1111e1-cec5-42c5-9ccf-936978e9f163"},{"version":"CommandV1","origId":3044375745343595,"guid":"d02ef394-fcf4-4287-b574-676deaf02afe","subtype":"command","commandType":"auto","position":1.072265625,"command":"%md  ### Build Data DataFrame\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \nSince Spark ML works on Spark DataFrame, I load the data as a RDD and the convert it to DataFrame. I apply the map() function for each line of the data to perform two tasks: <br \\>\n\n1)\tSplit a review sentence and a corresponding label by finding a tab (\\t )<br \\>\n(For example: [u'Good case, Excellent value.\\t1'] --> split --> [u'Good case, Excellent value.', u'1'])<br \\>\n\n2)\tCreate a RDD of Rows  with the field names : label and review<br \\>\n(For example: Row(label=u'1', review=u'Good case, Excellent value.'))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"32b2f6b4-e7a4-4fa9-96e1-3c9e5f8dd242"},{"version":"CommandV1","origId":3044375745343571,"guid":"6958efa7-a6a1-40c9-acce-a6ca40f36826","subtype":"command","commandType":"auto","position":1.0732421875,"command":"# Split a review sentence and a corresponding label \nrdd2 = rdd1.map(lambda x: x.split(\"\\t\"))\nrdd2.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">3</span><span class=\"ansired\">]: </span>\n[[u&apos;So there is no way for me to plug it in here in the US unless I go by a converter.&apos;,\n  u&apos;0&apos;],\n [u&apos;Good case, Excellent value.&apos;, u&apos;1&apos;],\n [u&apos;Great for the jawbone.&apos;, u&apos;1&apos;],\n [u&apos;Tied to charger for conversations lasting more than 45 minutes.MAJOR PROBLEMS!!&apos;,\n  u&apos;0&apos;],\n [u&apos;The mic is great.&apos;, u&apos;1&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;rdd1&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-2-d56b70726c33&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>rdd2 <span class=\"ansiyellow\">=</span> rdd1<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span> x<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;\\t&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> rdd2<span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;rdd1&apos; is not defined</div>","workflows":[],"startTime":1502991935976,"submitTime":1502991935746,"finishTime":1502991936203,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Build Data DataFrame","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"19845e31-069a-4250-9e37-8bec33db01e1"},{"version":"CommandV1","origId":3044375745343573,"guid":"1801a7ca-0cdd-42e7-9c5b-4bfea46774b2","subtype":"command","commandType":"auto","position":1.0751953125,"command":"# Create a RDD of Rows with the field names : label and review\nrdd3 = rdd2.map(lambda x: Row(review=x[0],label=x[1]))\nrdd3.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">4</span><span class=\"ansired\">]: </span>\n[Row(label=u&apos;0&apos;, review=u&apos;So there is no way for me to plug it in here in the US unless I go by a converter.&apos;),\n Row(label=u&apos;1&apos;, review=u&apos;Good case, Excellent value.&apos;),\n Row(label=u&apos;1&apos;, review=u&apos;Great for the jawbone.&apos;),\n Row(label=u&apos;0&apos;, review=u&apos;Tied to charger for conversations lasting more than 45 minutes.MAJOR PROBLEMS!!&apos;),\n Row(label=u&apos;1&apos;, review=u&apos;The mic is great.&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502991936360,"submitTime":1502991936316,"finishTime":1502991936485,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"78f02cbf-7956-4944-9fea-96895f1c55fa"},{"version":"CommandV1","origId":3044375745343596,"guid":"ae5de0d2-4c5f-447b-aade-21ff8b12e1de","subtype":"command","commandType":"auto","position":1.07666015625,"command":"%md \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \nOne of Sparks's modules is SparkSQL. SparkSQL is able to process structured data. SparkSQL has a SQLContext and a HiveContext. \nWith a SQLContext, I can convert the RDD of Rows to a DataFrame via createDataFrame method and register this DataFrame as a Temporary Table (named as “df”) in the SQLContext. The structure and content of the DataFrame is shown below. \n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f7afb514-d139-4eb4-aedc-c03fe6f0d07d"},{"version":"CommandV1","origId":3044375745343566,"guid":"a978680b-1ffe-4abc-9e68-39b12277e337","subtype":"command","commandType":"auto","position":1.078125,"command":"# Converting an RDD to DataFrame\ndf=sqlContext.createDataFrame(rdd3)\n# Registers this DataFrame as a temporary table using the given name\ndf.registerTempTable(\"df\")\n# convert String labels to Double type\ndf = df.withColumn(\"label\", df.label.cast(DoubleType()))\ndf.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+\n|label|              review|\n+-----+--------------------+\n|  0.0|So there is no wa...|\n|  1.0|Good case, Excell...|\n|  1.0|Great for the jaw...|\n|  0.0|Tied to charger f...|\n|  1.0|   The mic is great.|\n|  0.0|I have to jiggle ...|\n|  0.0|If you have sever...|\n|  1.0|If you are Razr o...|\n|  0.0|Needless to say, ...|\n|  0.0|What a waste of m...|\n|  1.0|And the sound qua...|\n|  1.0|He was very impre...|\n|  0.0|If the two were s...|\n|  1.0|Very good quality...|\n|  0.0|The design is ver...|\n|  1.0|Highly recommend ...|\n|  0.0|I advise EVERYONE...|\n|  1.0|    So Far So Good!.|\n|  1.0|       Works great!.|\n|  0.0|It clicks into pl...|\n+-----+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502991939593,"submitTime":1502991939548,"finishTime":1502991941006,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dd1c5ca5-a956-472d-884e-05353503ec96"},{"version":"CommandV1","origId":3044375745343597,"guid":"94185b73-0085-40bd-aa74-dfa02a27fc43","subtype":"command","commandType":"auto","position":1.0859375,"command":"%md  ### Feature extraction\n***labelIndexer*** \n<br \\>\nStringIndexer is applied as labelIndexer to convert the distinct labels in the input dataset to index values. Through StringIndexer, a new column \"indexedLabel\" is created by fitting all labels in the entire dataset, so that a classifier can recognize target label values. \n\n***RegexTokenizer*** \n<br \\>\nI use the RegexTokenizer function to break a review sentence into individual words. The parameter “pattern” (\"\\W\") is used to remove all non-word characters, such as , !. . The output of RegexTokenizer is called as \"words\".\n\n***StopWordsRemover*** \n<br \\>\nStop words are low-information words such as 'a', 'and', 'the'. These words are not particularly useful for text classification. The StopWordsRemover function takes the output of a RegexTokenizer (the \"words\" column) as input and removes all the stop words from the input sequences of words. Removing stop words can reduces the dimensionality of feature space. The output of StopWordsRemover is called as \"filtered\".\n\n***TF-IDF*** \n<br \\>\nTerm frequency-inverse document frequency (TF-IDF) is a feature extraction method for text classification to reflect the importance of a word to a document in the corpus. The HashingTF Transformer is used to convert a bag of filtered words (the \"filtered\" column) into fixed-length feature vectors (the \"rawFeatures\" column). HashingTF creates the term frequency vectors, TF(t,d), which is the number of times that a word t appears in a document d. The IDF Estimator takes feature vectors generated from HashingTF (the \"rawFeatures\" column) and scales each word by calculating log(Total number of documents / Number of documents with a word t in it). IDF weighs down the frequent words and scales up the rare ones. The resulting TF-IDF vectors are called as “features”. Therefore, I now have a vector field called “features” and a “double” field called “label”. The “features” and “label” are the default field names expected by a classifier.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"578315c2-8060-44a5-8507-60aefd5574cc"},{"version":"CommandV1","origId":3044375745343565,"guid":"1dd581b2-b7a3-4750-beee-9662b159ed80","subtype":"command","commandType":"auto","position":1.09375,"command":"# convert the distinct labels in the input dataset to index values\nlabelIndexer = StringIndexer(inputCol=\"label\", outputCol=\"indexedLabel\").fit(df)\n# tokenizer \ntokenizer = RegexTokenizer(inputCol=\"review\", outputCol=\"words\", pattern=\"\\W\")##'\\w' remove none-word letters\ndf_tokenized = tokenizer.transform(df)\n# remove stop words\nremover = StopWordsRemover(inputCol=\"words\", outputCol=\"filtered\")\ndf_removed = remover.transform(df_tokenized)\n# Convert to TF words vector\nhashingTF = HashingTF(inputCol=\"words\", outputCol=\"rawFeatures\")\ndf_TF = hashingTF.transform(df_tokenized)\n# Convert to TF*IDF words vector\nidf = IDF(inputCol=\"rawFeatures\", outputCol=\"features\")\nidfModel = idf.fit(df_TF)\ndf_idf = idfModel.transform(df_TF)\nfor features_label in df_idf.select(\"features\", \"label\").take(3):\n    print(features_label)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Row(features=SparseVector(262144, {15889: 1.5569, 16332: 2.1726, 21872: 5.8101, 24417: 1.1562, 52801: 6.2156, 61625: 5.5225, 86175: 1.3519, 103838: 0.9845, 113100: 4.4238, 133143: 4.7115, 150319: 5.2993, 156250: 3.6899, 172477: 4.9628, 180535: 4.0184, 188424: 3.1952, 199255: 4.8293, 205044: 1.7789, 221047: 3.5415, 222453: 4.9088, 227410: 1.6513}), label=0.0)\nRow(features=SparseVector(262144, {113432: 2.5913, 117481: 3.5766, 192310: 3.5076, 206496: 5.117}), label=1.0)\nRow(features=SparseVector(262144, {16332: 2.1726, 103838: 0.9845, 138356: 2.3238, 138642: 5.5225}), label=1.0)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;df&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-7-85eb8a2408a3&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># convert the distinct labels in the input dataset to index values</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>labelIndexer <span class=\"ansiyellow\">=</span> StringIndexer<span class=\"ansiyellow\">(</span>inputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;label&quot;</span><span class=\"ansiyellow\">,</span> outputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;indexedLabel&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansired\"># tokenizer</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> tokenizer <span class=\"ansiyellow\">=</span> RegexTokenizer<span class=\"ansiyellow\">(</span>inputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;review&quot;</span><span class=\"ansiyellow\">,</span> outputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;words&quot;</span><span class=\"ansiyellow\">,</span> pattern<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;\\W&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansired\">##&apos;\\w&apos; remove none-word letters</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> df_tokenized <span class=\"ansiyellow\">=</span> tokenizer<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;df&apos; is not defined</div>","workflows":[],"startTime":1502991944999,"submitTime":1502991944953,"finishTime":1502991947819,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Feature extraction","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c7b114a1-36af-44ef-9a46-29ca89ced09a"},{"version":"CommandV1","origId":3044375745343598,"guid":"41510110-92b4-432a-9de9-bdfd3325996f","subtype":"command","commandType":"auto","position":1.109375,"command":"%md  ### Split data\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nTo evaluate a model, I split data into train (80%) and test (20%) sets. To split input data, the randomSplit method is used to randomly split an RDD with the provided weights into new RDDs. \nI cache the train and test data in-memory by cache() because they will be called more than once during model building. \n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3d9e2292-50d8-41cf-959c-7a4452ac91bf"},{"version":"CommandV1","origId":3044375745343562,"guid":"7556e972-3d2d-4ced-a602-ca2a260fff98","subtype":"command","commandType":"auto","position":1.125,"command":"# Split data aproximately into training (80%) and test (20%)\n(train, test)=df.randomSplit([0.8,0.2], seed = 0)\n# Cache the train and test data in-memory \ntrain = train.cache()\ntest = test.cache()\nprint 'Sample number in the train set : {}'.format(train.count())\nprint 'Sample number in the test set : {}'.format(test.count())\ntrain.groupby('label').count().toPandas()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Sample number in the train set : 808\nSample number in the test set : 192\n<span class=\"ansired\">Out[</span><span class=\"ansired\">7</span><span class=\"ansired\">]: </span>\n   label  count\n0    0.0    407\n1    1.0    401\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;df&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-1-61cb5b06a3e6&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># Split data aproximately into training (80%) and test (20%)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span><span class=\"ansiyellow\">(</span>train<span class=\"ansiyellow\">,</span> test<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">=</span>df<span class=\"ansiyellow\">.</span>randomSplit<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0.8</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">0.2</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> seed <span class=\"ansiyellow\">=</span> <span class=\"ansicyan\">0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansired\"># Cache the train and test data in-memory</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> train <span class=\"ansiyellow\">=</span> train<span class=\"ansiyellow\">.</span>cache<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> test <span class=\"ansiyellow\">=</span> test<span class=\"ansiyellow\">.</span>cache<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;df&apos; is not defined</div>","workflows":[],"startTime":1502991949279,"submitTime":1502991949236,"finishTime":1502991951497,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Split data","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"48949b71-c0f1-4570-b559-0bd9691e1608"},{"version":"CommandV1","origId":3044375745343599,"guid":"f00ac54e-72cc-4864-bd18-995d37e5029b","subtype":"command","commandType":"auto","position":1.1875,"command":"%md  ### Data modeling\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nThe text data is trained by five classifiers : Logistic Regression, Naïve Bayes, Decision Tree, Random Forest, and Gradient Boosted Tree. During the stage of data modeling, it involves several steps:<br \\>\n***(1) Build a pipeline*** : <br \\>\nThe pipeline consists of labelIndexer, RegexTokenizer, StopWordsRemover, hashingTF, IDF, and a classifier. \n\n***(2) K-folds cross validation for hyperparameter tuning*** : <br \\>\nIn order to obtain the best model, I need to search for the best hyperparameters for the components in a pipeline. SparkML supports cross-validation for hyperparameter tuning. I use “ParamGridBuilder” to wrap multiple parameters, and then use “CrossValidator” for cross validation by fitting a model to the train data. By combining “ParamGridBuilder” and “CrossValidator”, a parameter grid search is performed through 4-fold cross validation at each grid point. The pipeline will return the best model using the fit() call, based on the score of a user-defined evaluator. I use “MulticlassClassificationEvaluator” to generate the Accuracy metric as an evaluator for cross validation. For each combination of all variable parameters, the average of the 4 performance scores in 4-fold cross validation is calculated. “CrossValidator” will compare the average scores and select the best model. \n\n***(3) Model prediction*** : <br \\> \nOnce the best model is chosen and trained by the train data, it can be used to predict the test data by using the transform() method. The prediction DataFrame will be created with the new output columns of \"rawPrediction\", \"probability\", and \"prediction\". \nThe “RawPrediction” means raw prediction probability for each possible label. This is a measure of confidence in each possible label. A larger value indicates more confidence for that label. \nThe “Probability” estimate the probability of each class, based on a given raw prediction.\nThe \"prediction\" gives a prediction label for each data instance. \n\n***(4) Model evaluation*** : <br \\>\nIn order to evaluate how well a model performs, several evaluation metrics to quantify the model performance are calculated.<br \\>\n**a) Accuracy** : I use “MulticlassClassificationEvaluator” to evaluate the classification accuracy for the test data by comparing the label column with the prediction column of the predicted DataFrame. <br \\>\n**b) F1 Score**: I use “MulticlassClassificationEvaluator” to evaluate the F1 score for the test data by comparing the label column with the prediction column of the predicted DataFrame. <br \\>\n**c) Classification report**: I use “classification_report” supported by Python Sklearn package to print a summary of the precision, recall, F1 score for each class.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bd3dbc98-a855-4d88-a72e-924411654287"},{"version":"CommandV1","origId":3044375745343600,"guid":"e9e93e22-2dd1-43cc-8f03-5660bb9e68ab","subtype":"command","commandType":"auto","position":1.21875,"command":"%md  #### Logistic Regression\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nFor a Logistic Regression model, the parameter grid (paramGrid) contains the parameters:\nnumFeatures (number of features for hashingTF),\nregParam (regularization parameter for a Logistic Regression classifier), \nelasticNetParam (the ElasticNet mixing parameter for a Logistic Regression classifier),\nmaxIter (max number of iterationsfor a Logistic Regression classifier).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8e430a9c-faec-4aee-bfc4-145e8d6ccbf8"},{"version":"CommandV1","origId":3044375745343561,"guid":"ff6a3435-4ac1-4c4e-ab07-f7e0a069cdce","subtype":"command","commandType":"auto","position":1.25,"command":"def grid_search(p1,p2,p3,p4):\n    lr = LogisticRegression()\n    pipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, lr])\n  \n    #Create ParamGrid for Cross Validation\n    paramGrid = (ParamGridBuilder()\n                 .addGrid(hashingTF.numFeatures, [p1])\n                 .addGrid(lr.regParam, [p2])\n                 .addGrid(lr.elasticNetParam, [p3])\n                 .addGrid(lr.maxIter, [p4])\n                 .build())\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\n    crossval = CrossValidator(estimator=pipeline,\n                              estimatorParamMaps=paramGrid,\n                              evaluator=evaluator,\n                              numFolds=4)\n    \n    ########  Run cross-validation, and choose the best set of parameters.\n    cvModel = crossval.fit(train)\n    # average cross-validation accuracy metric/s on all folds\n    average_score = cvModel.avgMetrics\n    print 'average cross-validation accuracy = {}'.format(average_score[0])\n    return average_score[0]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501887930458,"submitTime":1501887930415,"finishTime":1501887930538,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Logistic Regression","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"38b69f96-cf7e-4b7f-b8de-17b085061b2f"},{"version":"CommandV1","origId":3044375745343560,"guid":"c6c906a9-e2c7-463d-b2fd-a6429c35139f","subtype":"command","commandType":"auto","position":1.5,"command":"score=0.0\nfor p1 in [45000,50000,55000]:\n    for p2 in [0.09,0.10,0.11]:\n        for p3 in [0.09,0.10,0.11]:\n            for p4 in [9,10,11]:\n                t0 = time()\n                print '(numFeatures,regParam,elasticNetParam,maxIter)=({},{},{},{})'.format(p1,p2,p3,p4)\n                average_score=grid_search(p1,p2,p3,p4)\n                tt = time() - t0\n                print \"Classifier trained in {} seconds\".format(round(tt,3))\n                if average_score > score:\n                    print '################ Best score ######################'\n                    params=(p1,p2,p3,p4)\n                    score=average_score\nprint 'Best score is {} at params ={}'.format(score, params)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.09,9)\naverage cross-validation accuracy = 0.811270580966\nClassifier trained in 6.693 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.09,10)\naverage cross-validation accuracy = 0.813716365567\nClassifier trained in 6.813 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.09,11)\naverage cross-validation accuracy = 0.80963802736\nClassifier trained in 7.442 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.1,9)\naverage cross-validation accuracy = 0.809526420217\nClassifier trained in 6.462 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.1,10)\naverage cross-validation accuracy = 0.810842209691\nClassifier trained in 6.874 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.1,11)\naverage cross-validation accuracy = 0.811841235032\nClassifier trained in 7.091 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.11,9)\naverage cross-validation accuracy = 0.814077511487\nClassifier trained in 6.323 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.11,10)\naverage cross-validation accuracy = 0.817694409635\nClassifier trained in 6.734 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.09,0.11,11)\naverage cross-validation accuracy = 0.818851817043\nClassifier trained in 6.978 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.09,9)\naverage cross-validation accuracy = 0.808639002019\nClassifier trained in 6.276 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.09,10)\naverage cross-validation accuracy = 0.808513688736\nClassifier trained in 6.462 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.09,11)\naverage cross-validation accuracy = 0.812242194027\nClassifier trained in 6.811 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.1,9)\naverage cross-validation accuracy = 0.81301234858\nClassifier trained in 6.178 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.1,10)\naverage cross-validation accuracy = 0.817964398844\nClassifier trained in 6.528 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.1,11)\naverage cross-validation accuracy = 0.819121806252\nClassifier trained in 6.822 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.11,9)\naverage cross-validation accuracy = 0.810506082916\nClassifier trained in 6.097 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.11,10)\naverage cross-validation accuracy = 0.810333994709\nClassifier trained in 6.492 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.1,0.11,11)\naverage cross-validation accuracy = 0.810333994709\nClassifier trained in 6.754 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.09,9)\naverage cross-validation accuracy = 0.810842209691\nClassifier trained in 6.23 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.09,10)\naverage cross-validation accuracy = 0.810670121484\nClassifier trained in 6.381 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.09,11)\naverage cross-validation accuracy = 0.810670121484\nClassifier trained in 6.782 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.1,9)\naverage cross-validation accuracy = 0.810506082916\nClassifier trained in 6.004 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.1,10)\naverage cross-validation accuracy = 0.809190293442\nClassifier trained in 6.416 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.1,11)\naverage cross-validation accuracy = 0.811808166249\nClassifier trained in 6.761 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.11,9)\naverage cross-validation accuracy = 0.808013523392\nClassifier trained in 6.085 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.11,10)\naverage cross-validation accuracy = 0.807999817251\nClassifier trained in 6.509 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(45000,0.11,0.11,11)\naverage cross-validation accuracy = 0.802987285923\nClassifier trained in 6.699 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.09,9)\naverage cross-validation accuracy = 0.823074831175\nClassifier trained in 6.485 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.09,10)\naverage cross-validation accuracy = 0.820726947577\nClassifier trained in 6.77 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.09,11)\naverage cross-validation accuracy = 0.820693878794\nClassifier trained in 7.08 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.1,9)\naverage cross-validation accuracy = 0.826402377471\nClassifier trained in 6.41 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.1,10)\naverage cross-validation accuracy = 0.822766116681\nClassifier trained in 6.696 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.1,11)\naverage cross-validation accuracy = 0.820451301866\nClassifier trained in 7.078 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.11,9)\naverage cross-validation accuracy = 0.823831279588\nClassifier trained in 6.356 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.11,10)\naverage cross-validation accuracy = 0.825258676204\nClassifier trained in 6.586 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.09,0.11,11)\naverage cross-validation accuracy = 0.823956592871\nClassifier trained in 6.929 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.09,9)\naverage cross-validation accuracy = 0.821884354985\nClassifier trained in 6.221 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.09,10)\naverage cross-validation accuracy = 0.823074831175\nClassifier trained in 6.594 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.09,11)\naverage cross-validation accuracy = 0.819313257101\nClassifier trained in 6.882 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.1,9)\naverage cross-validation accuracy = 0.823956592871\nClassifier trained in 6.206 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.1,10)\naverage cross-validation accuracy = 0.827751235728\nClassifier trained in 6.741 seconds\n################ Best score ######################\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.1,11)\naverage cross-validation accuracy = 0.822799185464\nClassifier trained in 7.095 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.11,9)\naverage cross-validation accuracy = 0.817641978209\nClassifier trained in 6.222 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.11,10)\naverage cross-validation accuracy = 0.817786654135\nClassifier trained in 6.555 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.1,0.11,11)\naverage cross-validation accuracy = 0.815294094612\nClassifier trained in 6.937 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.09,9)\naverage cross-validation accuracy = 0.825370283347\nClassifier trained in 6.201 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.09,10)\naverage cross-validation accuracy = 0.82540335213\nClassifier trained in 6.601 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.09,11)\naverage cross-validation accuracy = 0.823055468532\nClassifier trained in 6.83 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.1,9)\naverage cross-validation accuracy = 0.818957767683\nClassifier trained in 6.169 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.1,10)\naverage cross-validation accuracy = 0.82157564049\nClassifier trained in 6.647 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.1,11)\naverage cross-validation accuracy = 0.8189246989\nClassifier trained in 7.017 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.11,9)\naverage cross-validation accuracy = 0.814459107839\nClassifier trained in 6.223 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.11,10)\naverage cross-validation accuracy = 0.809334969368\nClassifier trained in 6.571 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(50000,0.11,0.11,11)\naverage cross-validation accuracy = 0.810506082916\nClassifier trained in 7.104 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.09,9)\naverage cross-validation accuracy = 0.811827528892\nClassifier trained in 6.484 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.09,10)\naverage cross-validation accuracy = 0.812005273601\nClassifier trained in 7.193 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.09,11)\naverage cross-validation accuracy = 0.812005273601\nClassifier trained in 7.404 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.1,9)\naverage cross-validation accuracy = 0.816523296087\nClassifier trained in 6.512 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.1,10)\naverage cross-validation accuracy = 0.81417541249\nClassifier trained in 6.824 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.1,11)\naverage cross-validation accuracy = 0.811715921749\nClassifier trained in 7.255 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.11,9)\naverage cross-validation accuracy = 0.812695584447\nClassifier trained in 6.455 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.11,10)\naverage cross-validation accuracy = 0.812695584447\nClassifier trained in 6.748 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.09,0.11,11)\naverage cross-validation accuracy = 0.812583977304\nClassifier trained in 7.188 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.09,9)\naverage cross-validation accuracy = 0.815477495823\nClassifier trained in 6.667 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.09,10)\naverage cross-validation accuracy = 0.813274288151\nClassifier trained in 6.875 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.09,11)\naverage cross-validation accuracy = 0.81081479741\nClassifier trained in 7.148 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.1,9)\naverage cross-validation accuracy = 0.811682852966\nClassifier trained in 6.492 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.1,10)\naverage cross-validation accuracy = 0.812840260373\nClassifier trained in 6.902 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.1,11)\naverage cross-validation accuracy = 0.812840260373\nClassifier trained in 7.176 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.11,9)\naverage cross-validation accuracy = 0.811485745614\nClassifier trained in 6.359 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.11,10)\naverage cross-validation accuracy = 0.810328338207\nClassifier trained in 6.746 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.1,0.11,11)\naverage cross-validation accuracy = 0.809137862016\nClassifier trained in 7.064 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.09,9)\naverage cross-validation accuracy = 0.811827528892\nClassifier trained in 6.926 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.09,10)\naverage cross-validation accuracy = 0.810637052701\nClassifier trained in 6.853 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.09,11)\naverage cross-validation accuracy = 0.811827528892\nClassifier trained in 7.347 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.1,9)\naverage cross-validation accuracy = 0.811485745614\nClassifier trained in 6.618 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.1,10)\naverage cross-validation accuracy = 0.809012548733\nClassifier trained in 6.739 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.1,11)\naverage cross-validation accuracy = 0.810439945349\nClassifier trained in 7.176 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.11,9)\naverage cross-validation accuracy = 0.807980454609\nClassifier trained in 6.483 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.11,10)\naverage cross-validation accuracy = 0.81163042154\nClassifier trained in 6.869 seconds\n(numFeatures,regParam,elasticNetParam,maxIter)=(55000,0.11,0.11,11)\naverage cross-validation accuracy = 0.810439945349\nClassifier trained in 7.207 seconds\nBest score is 0.827751235728 at params =(50000, 0.1, 0.1, 10)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1501887989070,"submitTime":1501887989034,"finishTime":1501888531737,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"264cf4a9-ad9e-408f-be74-fa3f265074d7"},{"version":"CommandV1","origId":3044375745343576,"guid":"258a0b1a-7d2b-44d5-b2c7-7eb663d6e5a0","subtype":"command","commandType":"auto","position":1.5625,"command":"def Data_modeling(train, test, pipeline, paramGrid):\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\n    crossval = CrossValidator(estimator=pipeline,\n                              estimatorParamMaps=paramGrid,\n                              evaluator=evaluator,\n                              numFolds=4)\n    \n    ########  Run cross-validation, and choose the best set of parameters.\n    cvModel = crossval.fit(train)\n    \n    ########  Make predictions on on the test data\n    prediction = cvModel.transform(test)\n    average_score = cvModel.avgMetrics\n    print 'average cross-validation accuracy = {}'.format(average_score[0])\n    ######## Calculate accuracy of the prediction of the test data\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\n    accuracy_score=evaluator.evaluate(prediction)\n    # another way to calculate accuracy \n    #correct=prediction.filter(prediction['label']== prediction['prediction']).select(\"label\",\"prediction\")\n    #accuracy_score = correct.count() / float(test.count())  \n    print 'Accuracy in the test data = {}'.format(accuracy_score)\n    \n    ######## calculate F1 score of the prediction of the test data\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"label\", predictionCol=\"prediction\", metricName=\"f1\")\n    f1_score=evaluator.evaluate(prediction)\n    print 'F1 score in the test data = {}'.format(f1_score)  \n    # Calculate area under ROC for the prediction of the test data\n    #evaluator = BinaryClassificationEvaluator(labelCol=\"label\", metricName=\"areaUnderROC\")\n    #ROC_score=evaluator.evaluate(prediction)\n    #print 'areaUnderROC in the test data = {}'.format(ROC_score)\n    \n    ######## Print classification_report\n    prediction_and_labels=prediction.select(\"label\",\"prediction\")\n    y_true = []\n    y_pred = []\n    for x in prediction_and_labels.collect():\n        xx = list(x)\n        try:\n            tt = int(xx[1])\n            pp = int(xx[0])\n            y_true.append(tt)\n            y_pred.append(pp)\n        except:\n            continue\n\n    target_names = ['neg 0', 'pos 1']\n    print classification_report(y_true, y_pred, target_names=target_names)\n    return ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502991955666,"submitTime":1502991955618,"finishTime":1502991955764,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"50faae6c-53a1-4560-aba7-ebce68354216"},{"version":"CommandV1","origId":3044375745343568,"guid":"44972f52-26c7-43b5-92a3-ccde5478fe8d","subtype":"command","commandType":"auto","position":1.625,"command":"# trained by a logistic regression \nlr = LogisticRegression()\n# Build a pipeline\npipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, lr])\n\n# Create ParamGrid for Cross Validation \nparamGrid = (ParamGridBuilder()\n             .addGrid(hashingTF.numFeatures, [50000])\n             .addGrid(lr.regParam, [0.10])\n             .addGrid(lr.elasticNetParam, [0.10])\n             .addGrid(lr.maxIter, [10])\n             .build())\n# Execute 4-folds cross validation for hyperparameter tuning, model prediction and model evaluation.\nData_modeling(train, test, pipeline, paramGrid)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">average cross-validation accuracy = 0.827751235728\nAccuracy in the test data = 0.838541666667\nF1 score in the test data = 0.838142570963\n             precision    recall  f1-score   support\n\n      neg 0       0.90      0.79      0.84       106\n      pos 1       0.78      0.90      0.83        86\n\navg / total       0.85      0.84      0.84       192\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502991251901,"submitTime":1502991251863,"finishTime":1502991262987,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"46026ffc-bab5-4328-875e-3f09fb576be5"},{"version":"CommandV1","origId":3044375745343601,"guid":"20e6441f-d870-4f60-9249-54e5f63bc95c","subtype":"command","commandType":"auto","position":1.671875,"command":"%md  #### Naïve Bayes\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nFor a Naïve Bayes model, the parameter grid (paramGrid) contains the parameters:\nnumFeatures (number of features for hashingTF),\nsmoothing (smoothing parameter for a Naïve Bayes classifier). ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1af6a0e8-9d83-4e3a-8c74-a02bb722fba1"},{"version":"CommandV1","origId":3044375745343578,"guid":"ab04d5c1-620c-44c4-b7a7-2218533a713d","subtype":"command","commandType":"auto","position":1.71875,"command":"def grid_search(p1,p2):\n    nb = NaiveBayes()\n    pipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, nb])\n  \n    #Create ParamGrid for Cross Validation\n    paramGrid = (ParamGridBuilder()\n                 .addGrid(hashingTF.numFeatures, [p1])\n                 .addGrid(nb.smoothing, [p2])\n                 .build())\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\n    crossval = CrossValidator(estimator=pipeline,\n                              estimatorParamMaps=paramGrid,\n                              evaluator=evaluator,\n                              numFolds=4)\n    \n    ########  Run cross-validation, and choose the best set of parameters.\n    cvModel = crossval.fit(train)\n    # average cross-validation accuracy metric/s on all folds\n    average_score = cvModel.avgMetrics\n    print 'average cross-validation accuracy = {}'.format(average_score[0])\n    return average_score[0]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501553205136,"submitTime":1501553205119,"finishTime":1501553205175,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Naïve Bayes","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b58f9964-59c1-4f3d-b972-04cd449ec5ec"},{"version":"CommandV1","origId":3044375745343577,"guid":"f0eac7f2-6c47-47b2-8fef-aee9ff04c4cd","subtype":"command","commandType":"auto","position":1.8125,"command":"score=0.0\nfor p1 in [35000,40000,55000]:\n    for p2 in [0.8,0.9,1.0]:\n      t0 = time()\n      print '(numFeatures,smoothing)=({},{})'.format(p1,p2)\n      average_score=grid_search(p1,p2)\n      tt = time() - t0\n      print \"Classifier trained in {} seconds\".format(round(tt,3))\n      if average_score > score:\n        print '################ Best score ######################'\n        params=(p1,p2)\n        score=average_score\nprint 'Best score is {} at params ={}'.format(score, params)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(numFeatures,smoothing)=(35000,0.8)\naverage cross-validation accuracy = 0.811002984893\nClassifier trained in 2.939 seconds\n################ Best score ######################\n(numFeatures,smoothing)=(35000,0.9)\naverage cross-validation accuracy = 0.808524131509\nClassifier trained in 2.996 seconds\n(numFeatures,smoothing)=(35000,1.0)\naverage cross-validation accuracy = 0.8098068522\nClassifier trained in 2.881 seconds\n(numFeatures,smoothing)=(40000,0.8)\naverage cross-validation accuracy = 0.806385756057\nClassifier trained in 2.948 seconds\n(numFeatures,smoothing)=(40000,0.9)\naverage cross-validation accuracy = 0.80770154553\nClassifier trained in 3.017 seconds\n(numFeatures,smoothing)=(40000,1.0)\naverage cross-validation accuracy = 0.812397312726\nClassifier trained in 2.893 seconds\n################ Best score ######################\n(numFeatures,smoothing)=(55000,0.8)\naverage cross-validation accuracy = 0.798643744779\nClassifier trained in 3.072 seconds\n(numFeatures,smoothing)=(55000,0.9)\naverage cross-validation accuracy = 0.797453268588\nClassifier trained in 2.916 seconds\n(numFeatures,smoothing)=(55000,1.0)\naverage cross-validation accuracy = 0.799801152186\nClassifier trained in 3.008 seconds\nBest score is 0.812397312726 at params =(40000, 1.0)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: grid_search() takes exactly 2 arguments (4 given)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-47-5732580fd5f0&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      4</span>       t0 <span class=\"ansiyellow\">=</span> time<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span>       <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;(numFeatures,smoothing)=({},{})&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>p1<span class=\"ansiyellow\">,</span>p2<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 6</span><span class=\"ansiyellow\">       </span>average_score<span class=\"ansiyellow\">=</span>grid_search<span class=\"ansiyellow\">(</span>p1<span class=\"ansiyellow\">,</span>p2<span class=\"ansiyellow\">,</span>p3<span class=\"ansiyellow\">,</span>p4<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span>       tt <span class=\"ansiyellow\">=</span> time<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">-</span> t0<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span>       <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&quot;Classifier trained in {} seconds&quot;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>round<span class=\"ansiyellow\">(</span>tt<span class=\"ansiyellow\">,</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: grid_search() takes exactly 2 arguments (4 given)</div>","workflows":[],"startTime":1501554348891,"submitTime":1501554348882,"finishTime":1501554375640,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5ddbe73b-9a46-48b9-aa04-31c0959f1c3c"},{"version":"CommandV1","origId":3916221630513500,"guid":"7d7ad7c6-7eab-4722-b568-11afcb263bdc","subtype":"command","commandType":"auto","position":1.8271484375,"command":"# trained by a Naïve Bayes \nnb = NaiveBayes()\n# Build a pipeline\npipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, nb])\n# Create ParamGrid for Cross Validation \nparamGrid = (ParamGridBuilder()\n             .addGrid(hashingTF.numFeatures, [40000])\n             .addGrid(nb.smoothing, [1.0])\n             .build())\n# Execute 4-folds cross validation for hyperparameter tuning, model prediction and model evaluation.\nData_modeling(train, test, pipeline, paramGrid)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">average cross-validation accuracy = 0.812397312726\nAccuracy in the test data = 0.817708333333\nF1 score in the test data = 0.81725774141\n             precision    recall  f1-score   support\n\n      neg 0       0.88      0.77      0.82       106\n      pos 1       0.76      0.87      0.81        86\n\navg / total       0.83      0.82      0.82       192\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502991304639,"submitTime":1502991304600,"finishTime":1502991309287,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1aeb561a-55ce-4535-870e-eeb1cca74327"},{"version":"CommandV1","origId":3044375745343602,"guid":"70fb2af3-5038-409a-bb1f-cff900039b43","subtype":"command","commandType":"auto","position":1.830078125,"command":"%md  #### Decision Tree\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nFor a Decision Tree model, the parameter grid (paramGrid) contains the parameters:\nnumFeatures (number of features for hashingTF),\nmaxDepth (maximum depth of the tree for a Decision Tree classifier), \nminInstancesPerNode (minimum number of instances each child must have after split for a Decision Tree classifier). \n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f2b3f712-58c8-4eae-8d78-e3924f1eaad7"},{"version":"CommandV1","origId":3044375745343581,"guid":"930963e5-7671-46ea-a3f5-2a469bbdf836","subtype":"command","commandType":"auto","position":1.8359375,"command":"def grid_search(p1,p2,p3):\n    # trained by a Decision Tree \n    dt = DecisionTreeClassifier(labelCol=\"indexedLabel\",impurity=\"entropy\")\n    pipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, dt])\n  \n    #Create ParamGrid for Cross Validation\n    paramGrid = (ParamGridBuilder()\n                 .addGrid(hashingTF.numFeatures, [p1])\n                 .addGrid(dt.maxDepth, [p2])\n                 .addGrid(dt.minInstancesPerNode, [p3])\n                 .build())\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\n    crossval = CrossValidator(estimator=pipeline,\n                              estimatorParamMaps=paramGrid,\n                              evaluator=evaluator,\n                              numFolds=4)\n    \n    ########  Run cross-validation, and choose the best set of parameters.\n    cvModel = crossval.fit(train)\n    # average cross-validation accuracy metric/s on all folds\n    average_score = cvModel.avgMetrics\n    print 'average cross-validation accuracy = {}'.format(average_score[0])\n    return average_score[0]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501623571318,"submitTime":1501623571295,"finishTime":1501623571359,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Decision Tree","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"65a454bf-6886-4abc-8ef9-e5946a28e822"},{"version":"CommandV1","origId":3044375745343580,"guid":"5fc875e0-3d30-4c64-8231-8b9fc04f0eae","subtype":"command","commandType":"auto","position":1.859375,"command":"score=0.0\nfor p1 in [65000,70000,75000]:\n    for p2 in [23,24,25,26,27]:\n        for p3 in [3,4,5]:\n          t0 = time()\n          print '(numFeatures,maxDepth,minInstancesPerNode)=({},{},{})'.format(p1,p2,p3)\n          average_score=grid_search(p1,p2,p3)\n          tt = time() - t0\n          print \"Classifier trained in {} seconds\".format(round(tt,3))\n          if average_score > score:\n            print '################ Best score ######################'\n            params=(p1,p2,p3)\n            score=average_score\nprint 'Best score is {} at params ={}'.format(score, params)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(numFeatures,maxDepth,minInstancesPerNode)=(65000,23,3)\naverage cross-validation accuracy = 0.71958128829\nClassifier trained in 140.996 seconds\n################ Best score ######################\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,23,4)\naverage cross-validation accuracy = 0.723250617864\nClassifier trained in 133.0 seconds\n################ Best score ######################\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,23,5)\naverage cross-validation accuracy = 0.717257336048\nClassifier trained in 134.302 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,24,3)\naverage cross-validation accuracy = 0.718279204957\nClassifier trained in 136.68 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,24,4)\naverage cross-validation accuracy = 0.724441094055\nClassifier trained in 132.72 seconds\n################ Best score ######################\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,24,5)\naverage cross-validation accuracy = 0.720729558271\nClassifier trained in 132.96 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,25,3)\naverage cross-validation accuracy = 0.7144845621\nClassifier trained in 134.214 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,25,4)\naverage cross-validation accuracy = 0.729202998816\nClassifier trained in 133.757 seconds\n################ Best score ######################\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,25,5)\naverage cross-validation accuracy = 0.720729558271\nClassifier trained in 133.054 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,26,3)\naverage cross-validation accuracy = 0.718134529031\nClassifier trained in 136.065 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,26,4)\naverage cross-validation accuracy = 0.727887209343\nClassifier trained in 132.745 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,26,5)\naverage cross-validation accuracy = 0.717032816416\nClassifier trained in 134.996 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,27,3)\naverage cross-validation accuracy = 0.716687769772\nClassifier trained in 135.684 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,27,4)\naverage cross-validation accuracy = 0.722624051448\nClassifier trained in 133.528 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(65000,27,5)\naverage cross-validation accuracy = 0.710895946463\nClassifier trained in 135.203 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,23,3)\naverage cross-validation accuracy = 0.720515481412\nClassifier trained in 142.556 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,23,4)\naverage cross-validation accuracy = 0.731641821568\nClassifier trained in 141.49 seconds\n################ Best score ######################\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,23,5)\naverage cross-validation accuracy = 0.734018422793\nClassifier trained in 142.174 seconds\n################ Best score ######################\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,24,3)\naverage cross-validation accuracy = 0.721528212893\nClassifier trained in 139.615 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,24,4)\naverage cross-validation accuracy = 0.732832297758\nClassifier trained in 143.965 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,24,5)\naverage cross-validation accuracy = 0.734018422793\nClassifier trained in 140.581 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,25,3)\naverage cross-validation accuracy = 0.721528212893\nClassifier trained in 143.682 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,25,4)\naverage cross-validation accuracy = 0.745488939362\nClassifier trained in 141.256 seconds\n################ Best score ######################\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,25,5)\naverage cross-validation accuracy = 0.732861015386\nClassifier trained in 141.999 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,26,3)\naverage cross-validation accuracy = 0.725355924534\nClassifier trained in 146.868 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,26,4)\naverage cross-validation accuracy = 0.741541570941\nClassifier trained in 149.286 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,26,5)\naverage cross-validation accuracy = 0.732636495753\nClassifier trained in 144.433 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,27,3)\naverage cross-validation accuracy = 0.726546400724\nClassifier trained in 144.516 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,27,4)\naverage cross-validation accuracy = 0.73759420252\nClassifier trained in 144.465 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(70000,27,5)\naverage cross-validation accuracy = 0.732748102896\nClassifier trained in 145.912 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,23,3)\naverage cross-validation accuracy = 0.717444218184\nClassifier trained in 149.118 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,23,4)\naverage cross-validation accuracy = 0.724730445906\nClassifier trained in 153.304 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,23,5)\naverage cross-validation accuracy = 0.736477913534\nClassifier trained in 153.753 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,24,3)\naverage cross-validation accuracy = 0.720048384851\nClassifier trained in 161.33 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,24,4)\naverage cross-validation accuracy = 0.723539969716\nClassifier trained in 153.941 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,24,5)\naverage cross-validation accuracy = 0.736477913534\nClassifier trained in 173.974 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,25,3)\naverage cross-validation accuracy = 0.726079304163\nClassifier trained in 228.702 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,25,4)\naverage cross-validation accuracy = 0.730277299151\nClassifier trained in 204.917 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,25,5)\naverage cross-validation accuracy = 0.736333237608\nClassifier trained in 173.163 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,26,3)\naverage cross-validation accuracy = 0.728394118978\nClassifier trained in 222.216 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,26,4)\naverage cross-validation accuracy = 0.729901359301\nClassifier trained in 198.21 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,26,5)\naverage cross-validation accuracy = 0.731637470412\nClassifier trained in 191.135 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,27,3)\naverage cross-validation accuracy = 0.73067586501\nClassifier trained in 154.855 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,27,4)\naverage cross-validation accuracy = 0.72714446707\nClassifier trained in 156.344 seconds\n(numFeatures,maxDepth,minInstancesPerNode)=(75000,27,5)\naverage cross-validation accuracy = 0.733919216444\nClassifier trained in 153.274 seconds\nBest score is 0.745488939362 at params =(70000, 25, 4)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1501623585090,"submitTime":1501623585067,"finishTime":1501630386154,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"00176239-2cbe-4e77-9dd7-4ee0a19b594a"},{"version":"CommandV1","origId":3044375745343579,"guid":"f9896add-c496-423f-87ea-031e2b2f250d","subtype":"command","commandType":"auto","position":1.90625,"command":"# trained by a Decision Tree \ndt = DecisionTreeClassifier(labelCol=\"indexedLabel\",impurity=\"entropy\")\n# Build a pipeline\npipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, dt])\n# Create ParamGrid for Cross Validation\nparamGrid = (ParamGridBuilder()\n             .addGrid(hashingTF.numFeatures, [70000])\n             .addGrid(dt.maxDepth, [25])\n             .addGrid(dt.minInstancesPerNode, [4])\n             .build())\n# Execute 4-folds cross validation for hyperparameter tuning, model prediction and model evaluation.\nData_modeling(train, test, pipeline, paramGrid)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">average cross-validation accuracy = 0.745488939362\nAccuracy in the test data = 0.78125\nF1 score in the test data = 0.775478104213\n             precision    recall  f1-score   support\n\n      neg 0       0.96      0.70      0.81       127\n      pos 1       0.62      0.94      0.74        65\n\navg / total       0.84      0.78      0.79       192\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502991332701,"submitTime":1502991332663,"finishTime":1502991519837,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"40b8139e-f0d3-4736-8aee-bac8c1b4e6b9"},{"version":"CommandV1","origId":3044375745343603,"guid":"c8ec8055-9fae-43ce-bcb9-30724eecc16a","subtype":"command","commandType":"auto","position":1.953125,"command":"%md  #### Random Forest\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nFor a Random Forest model, the parameter grid (paramGrid) contains the parameters:\nnumFeatures (number of features for hashingTF),\nnumTrees (number of trees to train for a Random Forest classifier), \nmaxDepth (maximum depth of the tree for a Random Forest classifier), \nminInstancesPerNode (minimum number of instances each child must have after split for a Random Forest classifier). ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"221c52ca-a1ef-46e2-b12e-a0fc49eba4b4"},{"version":"CommandV1","origId":3044375745343559,"guid":"b07a43fb-9466-4f90-8f3b-f60eff808cbe","subtype":"command","commandType":"auto","position":2.0,"command":"def grid_search(p1,p2,p3,p4):\n    rf = RandomForestClassifier(labelCol=\"indexedLabel\",impurity=\"entropy\", seed=5043)\n    pipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, rf])\n  \n    #Create ParamGrid for Cross Validation\n    paramGrid = (ParamGridBuilder()\n                 .addGrid(hashingTF.numFeatures, [p1])\n                 .addGrid(rf.numTrees, [p2])\n                 .addGrid(rf.maxDepth, [p3])\n                 .addGrid(rf.minInstancesPerNode, [p4])\n                 .build())\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\n    crossval = CrossValidator(estimator=pipeline,\n                              estimatorParamMaps=paramGrid,\n                              evaluator=evaluator,\n                              numFolds=4)\n    \n    ########  Run cross-validation, and choose the best set of parameters.\n    cvModel = crossval.fit(train)\n    # average cross-validation accuracy metric/s on all folds\n    average_score = cvModel.avgMetrics\n    print 'average cross-validation accuracy = {}'.format(average_score[0])\n    return average_score[0]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1501676845387,"submitTime":1501676845360,"finishTime":1501676845426,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Random Forest","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cc4ba63d-efb5-4140-b477-e2cfb78e3010"},{"version":"CommandV1","origId":3140743701847186,"guid":"d4d3b025-c9b7-4c2f-a67a-2617ee372d04","subtype":"command","commandType":"auto","position":2.03515625,"command":"score=0.0\nfor p1 in [45000,50000,55000]:\n    for p2 in [30,31,32]:\n        for p3 in [28,29,30]:\n            for p4 in [1,2]:\n                t0 = time()\n                print '(numFeatures,numTrees,maxDepth,minInstancesPerNode)=({},{},{},{})'.format(p1,p2,p3,p4)\n                average_score=grid_search(p1,p2,p3,p4)\n                tt = time() - t0\n                print \"Classifier trained in {} seconds\".format(round(tt,3))\n                if average_score > score:\n                  print '################ Best score ######################'\n                  params=(p1,p2,p3,p4)\n                  score=average_score\nprint 'Best score is {} at params ={}'.format(score, params)\n#Best score is 0.77096908939 at params =(50000, 31, 29, 1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,30,28,1)\naverage cross-validation accuracy = 0.746833011348\nClassifier trained in 120.115 seconds\n################ Best score ######################\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,30,28,2)\naverage cross-validation accuracy = 0.74043659496\nClassifier trained in 126.766 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,30,29,1)\naverage cross-validation accuracy = 0.744472726956\nClassifier trained in 137.248 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,30,29,2)\naverage cross-validation accuracy = 0.743941885965\nClassifier trained in 123.785 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,30,30,1)\naverage cross-validation accuracy = 0.744584334099\nClassifier trained in 168.625 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,30,30,2)\naverage cross-validation accuracy = 0.74162707115\nClassifier trained in 185.98 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,31,28,1)\naverage cross-validation accuracy = 0.761371745336\nClassifier trained in 182.717 seconds\n################ Best score ######################\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,31,28,2)\naverage cross-validation accuracy = 0.74081144702\nClassifier trained in 166.162 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,31,29,1)\naverage cross-validation accuracy = 0.76359431565\nClassifier trained in 187.025 seconds\n################ Best score ######################\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,31,29,2)\naverage cross-validation accuracy = 0.742001923211\nClassifier trained in 172.378 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,31,30,1)\naverage cross-validation accuracy = 0.762166919034\nClassifier trained in 171.816 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,31,30,2)\naverage cross-validation accuracy = 0.74079774088\nClassifier trained in 149.889 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,32,28,1)\naverage cross-validation accuracy = 0.728302744709\nClassifier trained in 125.732 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,32,28,2)\naverage cross-validation accuracy = 0.750799742412\nClassifier trained in 117.223 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,32,29,1)\naverage cross-validation accuracy = 0.726986955235\nClassifier trained in 123.504 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,32,29,2)\naverage cross-validation accuracy = 0.749352983152\nClassifier trained in 120.101 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,32,30,1)\naverage cross-validation accuracy = 0.735761060638\nClassifier trained in 122.167 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(45000,32,30,2)\naverage cross-validation accuracy = 0.748195575745\nClassifier trained in 121.422 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,30,28,1)\naverage cross-validation accuracy = 0.76422153474\nClassifier trained in 133.017 seconds\n################ Best score ######################\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,30,28,2)\naverage cross-validation accuracy = 0.727269345238\nClassifier trained in 129.33 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,30,29,1)\naverage cross-validation accuracy = 0.767898913952\nClassifier trained in 134.824 seconds\n################ Best score ######################\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,30,29,2)\naverage cross-validation accuracy = 0.727269345238\nClassifier trained in 130.078 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,30,30,1)\naverage cross-validation accuracy = 0.770035984057\nClassifier trained in 138.88 seconds\n################ Best score ######################\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,30,30,2)\naverage cross-validation accuracy = 0.727269345238\nClassifier trained in 131.653 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,31,28,1)\naverage cross-validation accuracy = 0.76712767161\nClassifier trained in 132.41 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,31,28,2)\naverage cross-validation accuracy = 0.738717453356\nClassifier trained in 130.126 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,31,29,1)\naverage cross-validation accuracy = 0.77096908939\nClassifier trained in 133.337 seconds\n################ Best score ######################\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,31,29,2)\naverage cross-validation accuracy = 0.736085874408\nClassifier trained in 130.418 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,31,30,1)\naverage cross-validation accuracy = 0.768476529866\nClassifier trained in 138.275 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,31,30,2)\naverage cross-validation accuracy = 0.736085874408\nClassifier trained in 133.798 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,32,28,1)\naverage cross-validation accuracy = 0.743807435255\nClassifier trained in 135.59 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,32,28,2)\naverage cross-validation accuracy = 0.747204164926\nClassifier trained in 128.31 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,32,29,1)\naverage cross-validation accuracy = 0.739868116472\nClassifier trained in 134.847 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,32,29,2)\naverage cross-validation accuracy = 0.747204164926\nClassifier trained in 135.902 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,32,30,1)\naverage cross-validation accuracy = 0.737481507588\nClassifier trained in 137.06 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(50000,32,30,2)\naverage cross-validation accuracy = 0.747468497633\nClassifier trained in 139.084 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,30,28,1)\naverage cross-validation accuracy = 0.752626792676\nClassifier trained in 211.588 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,30,28,2)\naverage cross-validation accuracy = 0.717502306113\nClassifier trained in 144.54 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,30,29,1)\naverage cross-validation accuracy = 0.756803031885\nClassifier trained in 150.722 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,30,29,2)\naverage cross-validation accuracy = 0.713596056113\nClassifier trained in 146.04 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,30,30,1)\naverage cross-validation accuracy = 0.759276228766\nClassifier trained in 150.93 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,30,30,2)\naverage cross-validation accuracy = 0.714982334308\nClassifier trained in 154.388 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,31,28,1)\naverage cross-validation accuracy = 0.729698377889\nClassifier trained in 157.444 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,31,28,2)\naverage cross-validation accuracy = 0.723001296644\nClassifier trained in 145.211 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,31,29,1)\naverage cross-validation accuracy = 0.731000461223\nClassifier trained in 151.519 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,31,29,2)\naverage cross-validation accuracy = 0.723015002785\nClassifier trained in 153.287 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,31,30,1)\naverage cross-validation accuracy = 0.733835891813\nClassifier trained in 155.452 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,31,30,2)\naverage cross-validation accuracy = 0.717083289822\nClassifier trained in 147.909 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,32,28,1)\naverage cross-validation accuracy = 0.733984918894\nClassifier trained in 148.279 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,32,28,2)\naverage cross-validation accuracy = 0.708927266082\nClassifier trained in 144.563 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,32,29,1)\naverage cross-validation accuracy = 0.73039412768\nClassifier trained in 156.323 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,32,29,2)\naverage cross-validation accuracy = 0.707611476608\nClassifier trained in 151.805 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,32,30,1)\naverage cross-validation accuracy = 0.73304506927\nClassifier trained in 166.266 seconds\n(numFeatures,numTrees,maxDepth,minInstancesPerNode)=(55000,32,30,2)\naverage cross-validation accuracy = 0.707611476608\nClassifier trained in 147.262 seconds\nBest score is 0.77096908939 at params =(50000, 31, 29, 1)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;grid_search&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-11-fb3434244eff&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      6</span>                 t0 <span class=\"ansiyellow\">=</span> time<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span>                 <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;(numFeatures,numTrees,maxDepth,minInstancesPerNode)=({},{},{},{})&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>p1<span class=\"ansiyellow\">,</span>p2<span class=\"ansiyellow\">,</span>p3<span class=\"ansiyellow\">,</span>p4<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 8</span><span class=\"ansiyellow\">                 </span>average_score<span class=\"ansiyellow\">=</span>grid_search<span class=\"ansiyellow\">(</span>p1<span class=\"ansiyellow\">,</span>p2<span class=\"ansiyellow\">,</span>p3<span class=\"ansiyellow\">,</span>p4<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span>                 tt <span class=\"ansiyellow\">=</span> time<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">-</span> t0<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     10</span>                 <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&quot;Classifier trained in {} seconds&quot;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>round<span class=\"ansiyellow\">(</span>tt<span class=\"ansiyellow\">,</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;grid_search&apos; is not defined</div>","workflows":[],"startTime":1501682766315,"submitTime":1501682766305,"finishTime":1501690579535,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6184d455-8779-4001-aa04-78f24abb1614"},{"version":"CommandV1","origId":3044375745343587,"guid":"69340c26-fa62-4a88-bbbe-e207f34e50b2","subtype":"command","commandType":"auto","position":2.0625,"command":"rf = RandomForestClassifier(labelCol=\"indexedLabel\",impurity=\"entropy\", seed=5043)\n# Build a pipeline\npipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, rf])\n\n# Create ParamGrid for Cross Validation\nparamGrid = (ParamGridBuilder()\n             .addGrid(hashingTF.numFeatures, [50000])\n             .addGrid(rf.numTrees, [31])\n             .addGrid(rf.maxDepth, [29])\n             .addGrid(rf.minInstancesPerNode, [1])\n             .build())\n# Execute 4-folds cross validation for hyperparameter tuning, model prediction and model evaluation.\nData_modeling(train, test, pipeline, paramGrid)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">average cross-validation accuracy = 0.77096908939\nAccuracy in the test data = 0.8125\nF1 score in the test data = 0.812418478261\n             precision    recall  f1-score   support\n\n      neg 0       0.80      0.81      0.80        91\n      pos 1       0.83      0.81      0.82       101\n\navg / total       0.81      0.81      0.81       192\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 476.0 failed 1 times, most recent failure: Lost task 1.0 in stage 476.0 (TID 1127, localhost, executor driver): java.lang.UnsupportedOperationException: empty.maxBy","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-13-65c77053783c&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     11</span>              .build())\n<span class=\"ansigreen\">     12</span> <span class=\"ansired\"># Execute 4-folds cross validation for hyperparameter tuning, model prediction and model evaluation.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 13</span><span class=\"ansiyellow\"> </span>Data_modeling<span class=\"ansiyellow\">(</span>train<span class=\"ansiyellow\">,</span> test<span class=\"ansiyellow\">,</span> pipeline<span class=\"ansiyellow\">,</span> paramGrid<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-9-d2aecc17e148&gt;</span> in <span class=\"ansicyan\">Data_modeling</span><span class=\"ansiblue\">(train, test, pipeline, paramGrid)</span>\n<span class=\"ansigreen\">      7</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span>     <span class=\"ansired\">########  Run cross-validation, and choose the best set of parameters.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 9</span><span class=\"ansiyellow\">     </span>cvModel <span class=\"ansiyellow\">=</span> crossval<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>train<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     10</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     11</span>     <span class=\"ansired\">########  Make predictions on on the test data</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     62</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     63</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 64</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     66</span>             raise ValueError(&quot;Params must be either a param map or a list/tuple of param maps, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/tuning.py</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    234</span>             train <span class=\"ansiyellow\">=</span> df<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">~</span>condition<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    235</span>             <span class=\"ansigreen\">for</span> j <span class=\"ansigreen\">in</span> range<span class=\"ansiyellow\">(</span>numModels<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 236</span><span class=\"ansiyellow\">                 </span>model <span class=\"ansiyellow\">=</span> est<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>train<span class=\"ansiyellow\">,</span> epm<span class=\"ansiyellow\">[</span>j<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    237</span>                 <span class=\"ansired\"># TODO: duplicate evaluator to take extra params from input</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    238</span>                 metric <span class=\"ansiyellow\">=</span> eva<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>model<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>validation<span class=\"ansiyellow\">,</span> epm<span class=\"ansiyellow\">[</span>j<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     60</span>         <span class=\"ansigreen\">elif</span> isinstance<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">,</span> dict<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     61</span>             <span class=\"ansigreen\">if</span> params<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 62</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     63</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.py</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    106</span>                     dataset <span class=\"ansiyellow\">=</span> stage<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    107</span>                 <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span>  <span class=\"ansired\"># must be an Estimator</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 108</span><span class=\"ansiyellow\">                     </span>model <span class=\"ansiyellow\">=</span> stage<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    109</span>                     transformers<span class=\"ansiyellow\">.</span>append<span class=\"ansiyellow\">(</span>model<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    110</span>                     <span class=\"ansigreen\">if</span> i <span class=\"ansiyellow\">&lt;</span> indexOfLastEstimator<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     62</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     63</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 64</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     66</span>             raise ValueError(&quot;Params must be either a param map or a list/tuple of param maps, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    234</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    235</span>     <span class=\"ansigreen\">def</span> _fit<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 236</span><span class=\"ansiyellow\">         </span>java_model <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_fit_java<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    237</span>         <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_create_model<span class=\"ansiyellow\">(</span>java_model<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    238</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">_fit_java</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    231</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    232</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 233</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    234</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    235</span>     <span class=\"ansigreen\">def</span> _fit<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o4750.fit.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 476.0 failed 1 times, most recent failure: Lost task 1.0 in stage 476.0 (TID 1127, localhost, executor driver): java.lang.UnsupportedOperationException: empty.maxBy\n\tat scala.collection.TraversableOnce$class.maxBy(TraversableOnce.scala:223)\n\tat scala.collection.SeqViewLike$AbstractTransformed.maxBy(SeqViewLike.scala:43)\n\tat org.apache.spark.ml.tree.impl.RandomForest$.binsToBestSplit(RandomForest.scala:831)\n\tat org.apache.spark.ml.tree.impl.RandomForest$$anonfun$14.apply(RandomForest.scala:561)\n\tat org.apache.spark.ml.tree.impl.RandomForest$$anonfun$14.apply(RandomForest.scala:553)\n\tat scala.collection.Iterator$$anon$11.next(Iterator.scala:328)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:727)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1157)\n\tat scala.collection.generic.Growable$class.$plus$plus$eq(Growable.scala:48)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:103)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableOnce$class.to(TraversableOnce.scala:273)\n\tat scala.collection.AbstractIterator.to(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toBuffer(TraversableOnce.scala:265)\n\tat scala.collection.AbstractIterator.toBuffer(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toArray(TraversableOnce.scala:252)\n\tat scala.collection.AbstractIterator.toArray(Iterator.scala:1157)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1$$anonfun$13.apply(RDD.scala:936)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1$$anonfun$13.apply(RDD.scala:936)\n\tat org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:1963)\n\tat org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:1963)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1950)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1963)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1977)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:936)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:935)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$collectAsMap$1.apply(PairRDDFunctions.scala:748)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$collectAsMap$1.apply(PairRDDFunctions.scala:747)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.PairRDDFunctions.collectAsMap(PairRDDFunctions.scala:747)\n\tat org.apache.spark.ml.tree.impl.RandomForest$.findBestSplits(RandomForest.scala:563)\n\tat org.apache.spark.ml.tree.impl.RandomForest$.run(RandomForest.scala:198)\n\tat org.apache.spark.ml.classification.RandomForestClassifier.train(RandomForestClassifier.scala:137)\n\tat org.apache.spark.ml.classification.RandomForestClassifier.train(RandomForestClassifier.scala:45)\n\tat org.apache.spark.ml.Predictor.fit(Predictor.scala:96)\n\tat org.apache.spark.ml.Predictor.fit(Predictor.scala:72)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.UnsupportedOperationException: empty.maxBy\n\tat scala.collection.TraversableOnce$class.maxBy(TraversableOnce.scala:223)\n\tat scala.collection.SeqViewLike$AbstractTransformed.maxBy(SeqViewLike.scala:43)\n\tat org.apache.spark.ml.tree.impl.RandomForest$.binsToBestSplit(RandomForest.scala:831)\n\tat org.apache.spark.ml.tree.impl.RandomForest$$anonfun$14.apply(RandomForest.scala:561)\n\tat org.apache.spark.ml.tree.impl.RandomForest$$anonfun$14.apply(RandomForest.scala:553)\n\tat scala.collection.Iterator$$anon$11.next(Iterator.scala:328)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:727)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1157)\n\tat scala.collection.generic.Growable$class.$plus$plus$eq(Growable.scala:48)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:103)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableOnce$class.to(TraversableOnce.scala:273)\n\tat scala.collection.AbstractIterator.to(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toBuffer(TraversableOnce.scala:265)\n\tat scala.collection.AbstractIterator.toBuffer(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toArray(TraversableOnce.scala:252)\n\tat scala.collection.AbstractIterator.toArray(Iterator.scala:1157)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1$$anonfun$13.apply(RDD.scala:936)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1$$anonfun$13.apply(RDD.scala:936)\n\tat org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:1963)\n\tat org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:1963)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n</div>","workflows":[],"startTime":1502991968856,"submitTime":1502991968808,"finishTime":1502992104140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"30d1323f-06bf-4aa8-b1c0-a4ac1e3ff6fb"},{"version":"CommandV1","origId":3044375745343604,"guid":"fa78d8e3-0340-45ad-a2e7-bfb09a79ea1c","subtype":"command","commandType":"auto","position":2.09375,"command":"%md  #### Gradient Boosted Tree\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nFor a Gradient Boosted Tree model, the parameter grid (paramGrid) contains the parameters:\nnumFeatures (number of features for hashingTF),\nmaxIter (max number of iterations for a Gradient Boosted Tree classifier), \nmaxDepth (maximum depth of the tree for a Gradient Boosted Tree classifier), \nminInstancesPerNode (minimum number of instances each child must have after split for a Gradient Boosted Tree classifier). ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c29873da-0e5c-4567-bff0-040da2213e4e"},{"version":"CommandV1","origId":3044375745343586,"guid":"fdb9c437-93d5-4243-aee1-2bc4301525ed","subtype":"command","commandType":"auto","position":2.125,"command":"def grid_search(p1,p2,p3,p4):\n    gbt = GBTClassifier(labelCol=\"indexedLabel\")\n    pipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, gbt])\n  \n    #Create ParamGrid for Cross Validation\n    paramGrid = (ParamGridBuilder()\n                 .addGrid(hashingTF.numFeatures, [p1])\n                 .addGrid(gbt.maxIter, [p2]) #(default: 20)\n                 .addGrid(gbt.maxDepth, [p3])\n                 .addGrid(gbt.minInstancesPerNode, [p4])\n                 .build())\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\n    crossval = CrossValidator(estimator=pipeline,\n                              estimatorParamMaps=paramGrid,\n                              evaluator=evaluator,\n                              numFolds=4)\n    \n    ########  Run cross-validation, and choose the best set of parameters.\n    cvModel = crossval.fit(train)\n    # average cross-validation accuracy metric/s on all folds\n    average_score = cvModel.avgMetrics\n    print 'average cross-validation accuracy = {}'.format(average_score[0])\n    return average_score[0]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1502289299007,"submitTime":1502289298964,"finishTime":1502289299034,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Gradient Boosted Tree","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"36c656e3-f19e-4eb1-95a0-41fb0bb33d2e"},{"version":"CommandV1","origId":3044375745343585,"guid":"e39c06b9-7a78-4642-b191-faf404262fd3","subtype":"command","commandType":"auto","position":2.25,"command":"score=0.0\nfor p1 in [60000]:\n    for p2 in [25,26,27]:\n        for p3 in [18,19,20]:\n            for p4 in [2]:\n                t0 = time()\n                print '(numFeatures,maxIter,maxDepth,minInstancesPerNode)=({},{},{},{})'.format(p1,p2,p3,p4)\n                average_score=grid_search(p1,p2,p3,p4)\n                tt = time() - t0\n                print \"Classifier trained in {} seconds\".format(round(tt,3))\n                if average_score > score:\n                  print '################ Best score ######################'\n                  params=(p1,p2,p3,p4)\n                  score=average_scoreprint 'Best score is {} at params ={}'.format(score, params)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,25,18,2)\naverage cross-validation accuracy = 0.792351756126\nClassifier trained in 3129.069 seconds\n################ Best score ######################\n(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,25,19,2)\naverage cross-validation accuracy = 0.796522338833\nClassifier trained in 3179.31 seconds\n################ Best score ######################\n(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,25,20,2)\naverage cross-validation accuracy = 0.791444975285\nClassifier trained in 3305.012 seconds\n(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,26,18,2)\naverage cross-validation accuracy = 0.79365383946\nClassifier trained in 3291.467 seconds\n(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,26,19,2)\naverage cross-validation accuracy = 0.796522338833\nClassifier trained in 4967.6 seconds\n(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,26,20,2)\naverage cross-validation accuracy = 0.796266055764\nClassifier trained in 5453.051 seconds\n(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,27,18,2)\naverage cross-validation accuracy = 0.792351756126\nClassifier trained in 5480.282 seconds\n(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,27,19,2)\naverage cross-validation accuracy = 0.794207524018\nClassifier trained in 5387.827 seconds\n(numFeatures,maxIter,maxDepth,minInstancesPerNode)=(60000,27,20,2)\naverage cross-validation accuracy = 0.795108648357\nClassifier trained in 5579.014 seconds\nBest score is 0.796522338833 at params =(60000, 25, 19, 2)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;grid_search&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-10-bf967b24ea03&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      6</span>                 t0 <span class=\"ansiyellow\">=</span> time<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span>                 <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;(numFeatures,maxIter,maxDepth,minInstancesPerNode)=({},{},{},{})&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>p1<span class=\"ansiyellow\">,</span>p2<span class=\"ansiyellow\">,</span>p3<span class=\"ansiyellow\">,</span>p4<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 8</span><span class=\"ansiyellow\">                 </span>average_score<span class=\"ansiyellow\">=</span>grid_search<span class=\"ansiyellow\">(</span>p1<span class=\"ansiyellow\">,</span>p2<span class=\"ansiyellow\">,</span>p3<span class=\"ansiyellow\">,</span>p4<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span>                 tt <span class=\"ansiyellow\">=</span> time<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">-</span> t0<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     10</span>                 <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&quot;Classifier trained in {} seconds&quot;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>round<span class=\"ansiyellow\">(</span>tt<span class=\"ansiyellow\">,</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;grid_search&apos; is not defined</div>","workflows":[],"startTime":1502296098419,"submitTime":1502296098384,"finishTime":1502335871162,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"33b88965-5e51-4d86-bb6c-5fc7bd010c78"},{"version":"CommandV1","origId":3044375745343584,"guid":"256d222d-43c3-4819-89da-5bc35c5a57d3","subtype":"command","commandType":"auto","position":2.5,"command":"# trained by a Gradient Boosted Tree \ngbt = GBTClassifier(labelCol=\"indexedLabel\")\n# Build a pipeline\npipeline = Pipeline(stages=[labelIndexer,tokenizer, remover, hashingTF, idfModel, gbt])\n# Create ParamGrid for Cross Validation\nparamGrid = (ParamGridBuilder()\n             .addGrid(hashingTF.numFeatures, [60000])\n             .addGrid(gbt.maxIter, [25]) #(default: 20)\n             .addGrid(gbt.maxDepth, [19])\n             .addGrid(gbt.minInstancesPerNode, [2])\n             .build())\n# Execute 4-folds cross validation for hyperparameter tuning, model prediction and model evaluation.\nData_modeling(train, test, pipeline, paramGrid)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">average cross-validation accuracy = 0.796522338833\nAccuracy in the test data = 0.822916666667\nF1 score in the test data = 0.822145985203\n             precision    recall  f1-score   support\n\n      neg 0       0.90      0.77      0.83       109\n      pos 1       0.75      0.89      0.81        83\n\navg / total       0.84      0.82      0.82       192\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;rawPrediction&quot; does not exist.&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IllegalArgumentException</span>                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-16-909a8cf0523a&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     11</span>              .build())\n<span class=\"ansigreen\">     12</span> <span class=\"ansired\"># Execute 4-folds cross validation for hyperparameter tuning, model prediction and model evaluation.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 13</span><span class=\"ansiyellow\"> </span>Data_modeling<span class=\"ansiyellow\">(</span>train<span class=\"ansiyellow\">,</span> test<span class=\"ansiyellow\">,</span> pipeline<span class=\"ansiyellow\">,</span> paramGrid<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-15-d473df72ff4f&gt;</span> in <span class=\"ansicyan\">Data_modeling</span><span class=\"ansiblue\">(train, test, pipeline, paramGrid)</span>\n<span class=\"ansigreen\">     27</span>     <span class=\"ansired\"># Calculate area under ROC for the prediction of the test data</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     28</span>     evaluator <span class=\"ansiyellow\">=</span> BinaryClassificationEvaluator<span class=\"ansiyellow\">(</span>labelCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;label&quot;</span><span class=\"ansiyellow\">,</span> metricName<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;areaUnderROC&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 29</span><span class=\"ansiyellow\">     </span>ROC_score<span class=\"ansiyellow\">=</span>evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>prediction<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     30</span>     <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;areaUnderROC in the test data = {}&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>ROC_score<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     31</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">evaluate</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     67</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">_evaluate</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">     97</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">     98</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 99</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    100</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    101</span>     <span class=\"ansigreen\">def</span> isLargerBetter<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     77</span>                 <span class=\"ansigreen\">raise</span> QueryExecutionException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     78</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 79</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     80</span>             <span class=\"ansigreen\">raise</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     81</span>     <span class=\"ansigreen\">return</span> deco<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;rawPrediction&quot; does not exist.&apos;</div>","workflows":[],"startTime":1502388961855,"submitTime":1502388961798,"finishTime":1502392101304,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3799c96c-d76e-4476-b7ad-3dbf969a663b"},{"version":"CommandV1","origId":3140743701847202,"guid":"e9f4d8a6-fe18-4498-b9ab-836a40a0e0fd","subtype":"command","commandType":"auto","position":3.0,"command":"%md  ### Summary","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e9c12623-c68a-40cd-b238-46532e755ee3"},{"version":"CommandV1","origId":3916221630513511,"guid":"6dbd705a-d1b7-4e59-8b29-095416a0af3f","subtype":"command","commandType":"auto","position":3.5,"command":"%md \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nThe training time and classification accuracy in the test dataset of the five classifiers are compared, as shown in the below figure.  As we can see, the Naïve Bayes classifier uses the least execution time (2~3 seconds) while training a model. Naïve Bayes can be used when the training time is very crucial for the system. The Logistic Regression classifier achieves the best performance of prediction accuracy (0.838) on the test dataset and only takes 6 ~ 7 seconds to run the model, which is quite faster than all tree-based classifiers. The Decision tree and Random Forest classifiers have the poor performance, which are both slower and less accurate than the Logistic Regression and Naive Bayes algorithm. The predictive performance of the Decision Tree algorithm is far below the others. The predictive performance of the Gradient Boosted Tree classifier can achieve 82.29 % accuracy, which is a little bit below the best result by the Logistic Regression classifier. However, it takes almost 1 hour for a 25-iteration training run, which is computationally expensive. Therefore, the Logistic Regression algorithm can be considered as the ideal model for text classification problems because of its fast computing and good predictive performance.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"14171458-a28d-436c-9f56-7a9b4e7ffafd"},{"version":"CommandV1","origId":3044375745343583,"guid":"db3bf5f1-a6a7-42bf-96a3-527985996a12","subtype":"command","commandType":"auto","position":4.0,"command":"import matplotlib.pyplot as plt\nclassifier_names=['Logistic_Regression', 'Naive_Bayes', 'Decision_Tree', 'Random_Forest', 'Gradient_Boosted_Tree']\ntime=[6.41,2.893,141,133,3179]\naccuracy=[0.8385,0.8177,0.78125,0.8125,0.8229]\nfig, ax = plt.subplots(nrows=1,ncols=2,figsize=(18,5), facecolor='white')\nax[0].barh(np.arange(0, 5),time)\nax[0].set_yticks(np.arange(0.5, 5.5))\nax[0].set_yticklabels(classifier_names)\nax[0].grid(color='b', linestyle='--', linewidth=1)\nax[0].set_title('Model training time')\nax[0].set_xlabel('Time (sec)')\nax[0].set_xscale('log')\n\nax[1].barh(range(0, len(classifier_names)),accuracy)\nax[1].set_xlim([0.75,0.85])\nax[1].set_title('Model evaluation on the test set')\nax[1].set_xlabel('Accuracy')\nax[1].set_yticklabels([])\nax[1].grid(color='b', linestyle='--', linewidth=1)\ndisplay(fig)\n\n","commandVersion":0,"state":"finished","results":{"type":"image","data":"data:image/png;base64,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","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">ValueError</span>: incompatible sizes: argument &apos;width&apos; must be length 7 or scalar","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ValueError</span>                                Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-59-2fb0695e0a9e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      3</span> accuracy<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0.8385</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">0.8177</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">0.78125</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">0.8125</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">0.8229</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> fig<span class=\"ansiyellow\">,</span> ax <span class=\"ansiyellow\">=</span> plt<span class=\"ansiyellow\">.</span>subplots<span class=\"ansiyellow\">(</span>nrows<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span>ncols<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span>figsize<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">(</span><span class=\"ansicyan\">18</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> facecolor<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;white&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 5</span><span class=\"ansiyellow\"> </span>ax<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>barh<span class=\"ansiyellow\">(</span>np<span class=\"ansiyellow\">.</span>arange<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0.5</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">7.5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>time<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> ax<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>set_yticks<span class=\"ansiyellow\">(</span>np<span class=\"ansiyellow\">.</span>arange<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0.5</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">7.5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> ax<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>set_yticklabels<span class=\"ansiyellow\">(</span>classifier_names<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/matplotlib/axes/_axes.pyc</span> in <span class=\"ansicyan\">barh</span><span class=\"ansiblue\">(self, bottom, width, height, left, **kwargs)</span>\n<span class=\"ansigreen\">   2245</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2246</span>         patches = self.bar(left=left, height=height, width=width,\n<span class=\"ansigreen\">-&gt; 2247</span><span class=\"ansiyellow\">                            bottom=bottom, orientation=&apos;horizontal&apos;, **kwargs)\n</span><span class=\"ansigreen\">   2248</span>         <span class=\"ansigreen\">return</span> patches<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2249</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/matplotlib/__init__.pyc</span> in <span class=\"ansicyan\">inner</span><span class=\"ansiblue\">(ax, *args, **kwargs)</span>\n<span class=\"ansigreen\">   1817</span>                     warnings.warn(msg % (label_namer, func.__name__),\n<span class=\"ansigreen\">   1818</span>                                   RuntimeWarning, stacklevel=2)\n<span class=\"ansigreen\">-&gt; 1819</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> func<span class=\"ansiyellow\">(</span>ax<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">*</span>args<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kwargs<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1820</span>         pre_doc <span class=\"ansiyellow\">=</span> inner<span class=\"ansiyellow\">.</span>__doc__<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1821</span>         <span class=\"ansigreen\">if</span> pre_doc <span class=\"ansigreen\">is</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/matplotlib/axes/_axes.pyc</span> in <span class=\"ansicyan\">bar</span><span class=\"ansiblue\">(self, left, height, width, bottom, **kwargs)</span>\n<span class=\"ansigreen\">   2039</span>         <span class=\"ansigreen\">if</span> len<span class=\"ansiyellow\">(</span>width<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">!=</span> nbars<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2040</span>             raise ValueError(&quot;incompatible sizes: argument &apos;width&apos; &quot;\n<span class=\"ansigreen\">-&gt; 2041</span><span class=\"ansiyellow\">                              &quot;must be length %d or scalar&quot; % nbars)\n</span><span class=\"ansigreen\">   2042</span>         <span class=\"ansigreen\">if</span> len<span class=\"ansiyellow\">(</span>bottom<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">!=</span> nbars<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2043</span>             raise ValueError(&quot;incompatible sizes: argument &apos;bottom&apos; &quot;\n\n<span class=\"ansired\">ValueError</span>: incompatible sizes: argument &apos;width&apos; must be length 7 or scalar</div>","workflows":[],"startTime":1503001038347,"submitTime":1503001038312,"finishTime":1503001039335,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7a13a1a4-ca82-44f1-95e3-19a013fa99ae"}],"dashboards":[{"version":"DashboardViewV1","origId":3044375745343591,"guid":"19c26813-fafe-4819-9a9c-bb42f01020e7","nuid":"3d0ac0f7-ac94-4aa6-aca3-be30d6cc9ba3","title":"Untitled","width":1024,"layoutOption":{"stack":true,"grid":true},"elements":[{"guid":"da35751e-99a0-4b8f-a49b-b778f32c3ade","elementType":"command","elementNUID":"13797091-5766-4fdd-ad8e-d133753f1eee","position":{"width":12,"height":2,"x":0,"y":0,"z":null},"options":null}],"globalVars":{}}],"guid":"561dc12c-dcb5-4d91-b8c7-3f94998fc9d7","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
